<script>
  const GOOGLE_SHEETS_FORMULA = '=IMPORTHTML("{{ site.url }}{{ site.baseurl }}{{ page.url }}", "table", 1)'

  function getTranslation(key) {
    const lang = localStorage.getItem('preferred-language') || (navigator.language.startsWith('pl') ? 'pl' : 'en')
    const translations = {
      en: {{ site.data.translations.en | jsonify }},
      pl: {{ site.data.translations.pl | jsonify }}
    }
    return translations[lang]?.[key] || translations.en[key] || key
  }

  document.getElementById('googleSheetsBtn').addEventListener('click', () => {
    const instructions = document.getElementById('instructions')
    const button = document.getElementById('googleSheetsBtn')

    if (instructions.style.display === 'none') {
      instructions.style.display = 'block'
      button.innerHTML = '<i class="bi bi-arrow-up"></i> ' + getTranslation('hide_instructions')
    } else {
      instructions.style.display = 'none'
      button.innerHTML = '<i class="bi bi-table"></i> ' + getTranslation('import_to_sheets')
    }
  })

  document.getElementById('copyBtn').addEventListener('click', async () => {
    const copyBtn = document.getElementById('copyBtn')

    try {
      await navigator.clipboard.writeText(GOOGLE_SHEETS_FORMULA)

      const originalText = copyBtn.innerHTML
      copyBtn.innerHTML = '<i class="bi bi-check"></i> ' + getTranslation('copied')
      copyBtn.classList.remove('btn-primary')
      copyBtn.classList.add('btn-success')

      setTimeout(() => {
        copyBtn.innerHTML = originalText
        copyBtn.classList.remove('btn-success')
        copyBtn.classList.add('btn-primary')
      }, 2000)
    } catch (err) {
      console.error('Could not copy text: ', err)
      alert(`Could not copy to clipboard. Please copy manually: ${GOOGLE_SHEETS_FORMULA}`)
    }
  })
</script>

