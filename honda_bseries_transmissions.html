<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Honda B-Series Transmission Ratios</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <style>
      body {
        font-family: 'Courier New', monospace;
        font-weight: bold;
      }

      .number-cell {
        text-align: right;
      }

      #googleSheetsBtn {
        font-weight: bold;
        padding: 10px 20px;
        font-size: 16px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
      }

      #googleSheetsBtn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      }

      #copyBtn {
        transition: all 0.3s ease;
      }

      .alert {
        border-radius: 10px;
        border: none;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }

      code {
        background-color: #f8f9fa;
        padding: 8px 12px;
        border-radius: 4px;
        font-family: 'Courier New', monospace;
        font-size: 14px;
        word-break: break-all;
      }
    </style>
  </head>
  <body class="bg-light">
    <div class="container-fluid">
      <h1 class="text-center mb-4">Honda B-Series Transmission Ratios</h1>
      <div class="text-center mb-3">
        <button id="googleSheetsBtn" class="btn btn-success">
          <i class="bi bi-table"></i> Import to Google Sheets
        </button>
        <div id="instructions" class="mt-3" style="display: none;">
          <div class="alert alert-info">
            <h5><i class="bi bi-info-circle"></i> How to import this data into Google Sheets:</h5>
            <ol class="text-start">
              <li>Click "Copy Formula" below</li>
              <li>Go to <a href="https://sheets.google.com/create" target="_blank">Google Sheets</a> and create a new spreadsheet</li>
              <li>Paste the formula in cell A1 and press Enter</li>
              <li>The data will automatically load!</li>
            </ol>
            <button id="copyBtn" class="btn btn-primary">
              <i class="bi bi-clipboard"></i> Copy Formula
            </button>
          </div>
        </div>
      </div>
      <div class="table-responsive">
        <table class="table table-bordered shadow rounded-3 overflow-hidden text-sm-start text-xs-start">
          <thead>
            <tr>
              <th scope="col" class="bg-primary text-white">Year/Make</th>
              <th scope="col" class="bg-primary text-white">Market</th>
              <th scope="col" class="bg-primary text-white">Type</th>
              <th scope="col" class="bg-primary text-white">Tranny Code</th>
              <th scope="col" class="bg-primary text-white">1st Gear</th>
              <th scope="col" class="bg-primary text-white">2nd Gear</th>
              <th scope="col" class="bg-primary text-white">3rd Gear</th>
              <th scope="col" class="bg-primary text-white">4th Gear</th>
              <th scope="col" class="bg-primary text-white">5th Gear</th>
              <th scope="col" class="bg-primary text-white">Reverse</th>
              <th scope="col" class="bg-primary text-white">Final Drive</th>
              <th scope="col" class="bg-primary text-white">Notes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">90-91 Integra XSi</th>
              <td>JDM</td>
              <td>Cable</td>
              <td>S1/J1</td>
              <td class="number-cell">3.230</td>
              <td class="number-cell">2.105</td>
              <td class="number-cell">1.458</td>
              <td class="number-cell">1.107</td>
              <td class="number-cell">0.848</td>
              <td class="number-cell">3.000</td>
              <td class="number-cell">4.400</td>
              <td>No LSD</td>
            </tr>
            <tr>
              <th scope="row">CRX/Civic SiR (EF8/9)</th>
              <td>JDM</td>
              <td>Cable</td>
              <td>Y1</td>
              <td class="number-cell">3.166</td>
              <td class="number-cell">2.052</td>
              <td class="number-cell">1.416</td>
              <td class="number-cell">1.103</td>
              <td class="number-cell">0.873</td>
              <td class="number-cell">4.000</td>
              <td class="number-cell">2.660</td>
              <td>Opt LSD</td>
            </tr>
            <tr>
              <th scope="row">90-93 Integra RS/LS/GS</th>
              <td>USDM</td>
              <td>Cable</td>
              <td>S1/YS1</td>
              <td class="number-cell">3.166</td>
              <td class="number-cell">1.857</td>
              <td class="number-cell">1.259</td>
              <td class="number-cell">0.935</td>
              <td class="number-cell">0.742</td>
              <td class="number-cell">3.000</td>
              <td class="number-cell">4.400</td>
              <td>No LSD</td>
            </tr>
            <tr>
              <th scope="row">92-93 Integra GSR/XSi</th>
              <td>USDM/JDM</td>
              <td>Cable</td>
              <td>YS1</td>
              <td class="number-cell">3.230</td>
              <td class="number-cell">2.105</td>
              <td class="number-cell">1.458</td>
              <td class="number-cell">1.107</td>
              <td class="number-cell">0.848</td>
              <td class="number-cell">3.000</td>
              <td class="number-cell">4.400</td>
              <td>JDM Opt LSD</td>
            </tr>
            <tr>
              <th scope="row">94-2001 Integra LS/RS/GS/SE</th>
              <td>USDM</td>
              <td>Hydro</td>
              <td>S80</td>
              <td class="number-cell">3.230</td>
              <td class="number-cell">1.900</td>
              <td class="number-cell">1.269</td>
              <td class="number-cell">0.966</td>
              <td class="number-cell">0.714</td>
              <td class="number-cell">3.000</td>
              <td class="number-cell">4.266</td>
              <td>No LSD</td>
            </tr>
            <tr>
              <th scope="row">94-2001 Integra GSR/SiR -G</th>
              <td>USDM/JDM</td>
              <td>Hydro</td>
              <td>S80/Y80</td>
              <td class="number-cell">3.230</td>
              <td class="number-cell">1.900</td>
              <td class="number-cell">1.360</td>
              <td class="number-cell">1.034</td>
              <td class="number-cell">0.787</td>
              <td class="number-cell">3.000</td>
              <td class="number-cell">4.400</td>
              <td>JDM Opt LSD</td>
            </tr>
            <tr>
              <th scope="row">96-97 Integra Type R / Civic Type R (EK9) / Civic SiR (EK4 & EG6)</th>
              <td>USDM/JDM</td>
              <td>Hydro</td>
              <td>Y21/Y80/S80/S4C</td>
              <td class="number-cell">3.230</td>
              <td class="number-cell">2.105</td>
              <td class="number-cell">1.458</td>
              <td class="number-cell">1.107</td>
              <td class="number-cell">0.848</td>
              <td class="number-cell">3.000</td>
              <td class="number-cell">4.400</td>
              <td>LSD on R Opt on SiR</td>
            </tr>
            <tr>
              <th scope="row">1998-2001 Integra Type R</th>
              <td>JDM</td>
              <td>Hydro</td>
              <td>S80</td>
              <td class="number-cell">3.230</td>
              <td class="number-cell">2.105</td>
              <td class="number-cell">1.458</td>
              <td class="number-cell">1.034</td>
              <td class="number-cell">0.787</td>
              <td class="number-cell">3.000</td>
              <td class="number-cell">4.785</td>
              <td>LSD</td>
            </tr>
            <tr>
              <th scope="row">95-97 Del Sol VTEC / 99-01 Civic Si</th>
              <td>USDM</td>
              <td>Hydro</td>
              <td>Y21/S21</td>
              <td class="number-cell">3.230</td>
              <td class="number-cell">2.105</td>
              <td class="number-cell">1.458</td>
              <td class="number-cell">1.107</td>
              <td class="number-cell">0.848</td>
              <td class="number-cell">3.000</td>
              <td class="number-cell">4.400</td>
              <td>No LSD</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <script>
      const GOOGLE_SHEETS_FORMULA = '=IMPORTHTML("https://honda-wawa.github.io/honda_bseries_transmissions.html", "table", 1)'

      document.getElementById('googleSheetsBtn').addEventListener('click', () => {
        const instructions = document.getElementById('instructions')
        const button = document.getElementById('googleSheetsBtn')

        if (instructions.style.display === 'none') {
          instructions.style.display = 'block'
          button.innerHTML = '<i class="bi bi-arrow-up"></i> Hide Instructions'
        } else {
          instructions.style.display = 'none'
          button.innerHTML = '<i class="bi bi-table"></i> Import to Google Sheets'
        }
      })

      document.getElementById('copyBtn').addEventListener('click', async () => {
        const copyBtn = document.getElementById('copyBtn')

        try {
          await navigator.clipboard.writeText(GOOGLE_SHEETS_FORMULA)

          const originalText = copyBtn.innerHTML
          copyBtn.innerHTML = '<i class="bi bi-check"></i> Copied!'
          copyBtn.classList.remove('btn-outline-primary')
          copyBtn.classList.add('btn-success')

          setTimeout(() => {
            copyBtn.innerHTML = originalText
            copyBtn.classList.remove('btn-success')
            copyBtn.classList.add('btn-outline-primary')
          }, 2000)
        } catch (err) {
          console.error('Could not copy text: ', err)
          alert(`Could not copy to clipboard. Please copy manually: ${GOOGLE_SHEETS_FORMULA}`)
        }
      })
    </script>
  </body>
</html>
